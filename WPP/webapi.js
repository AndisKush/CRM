(()=>{var e={40:e=>{e.exports={replaceVariables:(e,t)=>{const s={"{nomecliente}":t.cliente?.nome&&t.cliente?.nome.trim(),"{nomeusuario}":t.user?.nome&&t.user?.nome.trim()};return e.replace(/{nomecliente}|{nomeusuario}/gi,(e=>s[e]))}}},487:(e,t,s)=>{const n=s(121),{Client:o,LocalAuth:r}=s(55),i=s(572),a=s(40),u="2.2412.54",c=new o({webVersion:u,webVersionCache:{type:"remote",remotePath:`https://raw.githubusercontent.com/wppconnect-team/wa-version/main/html/${u}.html`},authStrategy:new r({dataPath:"./.wwebjs_auth/session"}),puppeteer:{headless:!0,args:["--no-sandbox","--no-first-run","--disable-setuid-sandbox","--disable-dev-shm-usage","--disable-accelerated-2d-canvas","--disable-gpu","--single-process","--no-zygote"]}});let l,d=!1;async function m(e){if(!e||""===e)return null;let t=null,s="";return e&&null!==e&&""!==e&&(s=i(e.toString(),"BR")?.format("E.164")?.replace("+",""),s&&parseFloat(s.substr(2,2))>=28&&13===s.length&&(s=s.substr(0,4)+s.substr(5,8)),s&&(s=s&&s.includes("@c.us")?s:`${s}@c.us`)),null===t&&(t=s),t}async function p(e){return!!e&&new Promise(((t,s)=>{c.isRegisteredUser(e).then((e=>{t(!!e)})).catch((e=>{console.error(e),s(e)}))}))}c.on("qr",(e=>{n.toDataURL(e,(function(e,t){console.log("Aguardando leitura QRCode"),l=t}))})),c.on("ready",(()=>{console.log("Cliente pronto"),d=!0,l=null})),c.on("disconnected",(()=>{console.log("Aparelho Desconectado"),d=!1,c.initialize()})),e.exports={initialize:()=>{c.initialize()},sendText:async function(e,t,s,n){if(!e||""===e)return n({status:!1,msg:"Mensagem Vazia - Verifique as configurações"});if(!t||t?.length<=0)return n({status:!1,msg:"Sem Destino de Envio - Verifique as configurações"});for(let e=0;e<t.length;e++)t[e]=await m(t[e]);let o=0;e=await a.replaceVariables(e,s);for(const s of t)await new Promise((e=>{setTimeout(e,1e3)})),await p(s)?await c.sendMessage(s,e).catch((e=>{console.log("erro:"),console.log(e)})):o+=1;return n({status:!0,msg:"Enviado Mensagem"+(o>0?`, Erros: ${o}`:"")})},qrCode:()=>l,isConnected:()=>d}},582:e=>{"use strict";e.exports=require("cors")},860:e=>{"use strict";e.exports=require("express")},572:e=>{"use strict";e.exports=require("libphonenumber-js")},121:e=>{"use strict";e.exports=require("qrcode")},55:e=>{"use strict";e.exports=require("whatsapp-web.js")}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,s),r.exports}(()=>{const e=s(860),t=s(582),n=s(487),o=e();o.use(t()),o.use(e.urlencoded({extended:!1,limit:"50mb"})),o.use(e.json({limit:"50mb"}));try{n.initialize()}catch(e){console.log(e)}o.get("/status",((e,t)=>t.status(200).json({qrcode:n.qrCode(),connected:n.isConnected()}))),o.post("/enviamensagem",(async(e,t)=>{const{mensagem:s,destino:o,dado:r}=e.body;await n.sendText(s,o,r,(function(e){return t.status(200).json(e)}))})),o.listen(5002,(()=>{console.log(">>> WebApi started <<<")}))})()})();